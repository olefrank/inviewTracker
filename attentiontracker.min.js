var AttentionTracker=(function(){var o;var e=0;var h;var d=0;var f;var s;var g;var r;var p={element:document.querySelector(".article"),pctInView:90,eventHandler:i,heartbeatInterval:2000,heartbeatExpires:180000};function j(){window.onscroll=function(){clearTimeout(o);o=setTimeout(function(){if(c()){if(!f){k()}}else{if(f){m();e+=q()}}},150)};window.onload=function(){l();if(c()){k()}};window.onbeforeunload=function(){p.eventHandler("totaltime: "+e)};window.onblur=function(){if(f){m();e+=q()}};window.onfocus=function(){l();if(c()){if(!f){k()}}}}function l(){var u=p.pctInView/100;g=(window.innerHeight*(1-u));r=(window.innerHeight*u)}function k(){s=new Date();f=true;if(d===0){p.eventHandler("heartbeatDelay "+d+"="+e);d++}if(e<p.heartbeatExpires){h=setInterval(function(){e+=q();if(e>p.heartbeatExpires){clearInterval(h)}else{s=new Date();p.eventHandler("heartbeatDelay "+d+"="+e);d++}},p.heartbeatInterval)}}function m(){f=false;clearInterval(h)}function q(){var u=0;if(s!==undefined){u=new Date().getTime()-s.getTime()}return u}function c(){var u=p.element.getBoundingClientRect();if(u.height<window.innerHeight){return t(u)}else{return b(u)}}function b(u){return(u.top<=g)&&(u.bottom>=r)}function t(v,u){return(v.top>=0)&&(v.bottom<=(window.innerHeight||u.clientHeight))}function i(u){console.log("simulate event: "+u)}function a(v){for(var u in v){p[u]=v[u]}}function n(u){a(u);j()}return{init:n}})();